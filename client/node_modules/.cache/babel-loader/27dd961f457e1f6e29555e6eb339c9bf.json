{"ast":null,"code":"'use strict';\n\nconst mergeOptions = require('merge-options');\n\nconst multicodec = require('multicodec'); // All known (non-default) IPLD formats\n\n\nconst IpldFormats = {\n  get [multicodec.DAG_PB]() {\n    return require('ipld-dag-pb');\n  },\n\n  get [multicodec.DAG_CBOR]() {\n    return require('ipld-dag-cbor');\n  },\n\n  get [multicodec.RAW]() {\n    return require('ipld-raw');\n  }\n\n};\n\nmodule.exports = (blockService, options = {}, log) => {\n  return mergeOptions.call( // ensure we have the defaults formats even if the user overrides `formats: []`\n  {\n    concatArrays: true\n  }, {\n    blockService: blockService,\n    loadFormat: codec => {\n      log('Loading IPLD format', codec);\n\n      if (IpldFormats[codec]) {\n        return IpldFormats[codec];\n      } else {\n        throw new Error(\"Missing IPLD format \\\"\".concat(multicodec.getName(codec), \"\\\"\"));\n      }\n    }\n  }, options);\n};","map":null,"metadata":{},"sourceType":"script"}