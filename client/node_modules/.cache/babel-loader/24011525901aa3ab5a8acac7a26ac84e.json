{"ast":null,"code":"'use strict';\n\nconst IpnsPubsubDatastore = require('../../../ipns/routing/pubsub-datastore');\n\nconst errcode = require('err-code');\n/**\n * Get pubsub from IPNS routing\n *\n * @param {import('.').IPNS} ipns\n * @param {PubSubRoutingOptions} [options]\n */\n\n\nexports.getPubsubRouting = (ipns, options) => {\n  if (!ipns || !(options && options.ipnsPubsub)) {\n    throw errcode(new Error('IPNS pubsub subsystem is not enabled'), 'ERR_IPNS_PUBSUB_NOT_ENABLED');\n  } // Only one store and it is pubsub\n\n\n  if (IpnsPubsubDatastore.isIpnsPubsubDatastore(ipns.routing)) {\n    return ipns.routing;\n  } // Find in tiered\n\n\n  const pubsub = (ipns.routing.stores || []).find(s => IpnsPubsubDatastore.isIpnsPubsubDatastore(s));\n\n  if (!pubsub) {\n    throw errcode(new Error('IPNS pubsub datastore not found'), 'ERR_PUBSUB_DATASTORE_NOT_FOUND');\n  }\n\n  return pubsub;\n};\n/**\n * @typedef {Object} PubSubRoutingOptions\n * @property {boolean} [ipnsPubsub] - Enable pub-sub on IPNS. (Default: `false`)\n */","map":null,"metadata":{},"sourceType":"script"}