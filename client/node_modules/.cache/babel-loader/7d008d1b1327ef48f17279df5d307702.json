{"ast":null,"code":"'use strict';\n\nmodule.exports = function clear(db, location, keyRange, options, callback) {\n  if (options.limit === 0) return db._nextTick(callback);\n  var transaction = db.db.transaction([location], 'readwrite');\n  var store = transaction.objectStore(location);\n  var count = 0;\n\n  transaction.oncomplete = function () {\n    callback();\n  };\n\n  transaction.onabort = function () {\n    callback(transaction.error || new Error('aborted by user'));\n  }; // A key cursor is faster (skips reading values) but not supported by IE\n\n\n  var method = store.openKeyCursor ? 'openKeyCursor' : 'openCursor';\n  var direction = options.reverse ? 'prev' : 'next';\n\n  store[method](keyRange, direction).onsuccess = function (ev) {\n    var cursor = ev.target.result;\n\n    if (cursor) {\n      // Wait for a request to complete before continuing, saving CPU.\n      store.delete(cursor.key).onsuccess = function () {\n        if (options.limit <= 0 || ++count < options.limit) {\n          cursor.continue();\n        }\n      };\n    }\n  };\n};","map":null,"metadata":{},"sourceType":"script"}