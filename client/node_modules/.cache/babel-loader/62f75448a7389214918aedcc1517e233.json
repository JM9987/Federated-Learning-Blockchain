{"ast":null,"code":"'use strict';\n\nrequire('node-forge/lib/aes');\n\nconst forge = require('node-forge/lib/forge');\n\nconst uint8ArrayToString = require('uint8arrays/to-string');\n\nconst uint8ArrayFromString = require('uint8arrays/from-string');\n\nmodule.exports = {\n  createCipheriv: (mode, key, iv) => {\n    const cipher2 = forge.cipher.createCipher('AES-CTR', uint8ArrayToString(key, 'ascii'));\n    cipher2.start({\n      iv: uint8ArrayToString(iv, 'ascii')\n    });\n    return {\n      update: data => {\n        cipher2.update(forge.util.createBuffer(uint8ArrayToString(data, 'ascii')));\n        return uint8ArrayFromString(cipher2.output.getBytes(), 'ascii');\n      }\n    };\n  },\n  createDecipheriv: (mode, key, iv) => {\n    const cipher2 = forge.cipher.createDecipher('AES-CTR', uint8ArrayToString(key, 'ascii'));\n    cipher2.start({\n      iv: uint8ArrayToString(iv, 'ascii')\n    });\n    return {\n      update: data => {\n        cipher2.update(forge.util.createBuffer(uint8ArrayToString(data, 'ascii')));\n        return uint8ArrayFromString(cipher2.output.getBytes(), 'ascii');\n      }\n    };\n  }\n};","map":null,"metadata":{},"sourceType":"script"}